import numpy as np

LETTER_FREQUENCIES = {'A': 0.0817, 'B': 0.0149, 'C': 0.0278, 'D': 0.0425, 
                      'E': 0.127, 'F': 0.0223, 'G': 0.0202, 'H': 0.0609, 
                      'I': 0.0697, 'J': 0.0015, 'K': 0.0077, 'L': 0.0403, 
                      'M': 0.0241, 'N': 0.0675, 'O': 0.0751, 'P': 0.0193, 
                      'Q': 0.001, 'R': 0.0599, 'S': 0.0633, 'T': 0.0906, 
                      'U': 0.0276, 'V': 0.0098, 'W': 0.0236, 'X': 0.0015, 
                      'Y': 0.0197, 'Z': 0.0007}

E = np.array([
    #   a           b           c           d           e           etc
    [0.00013525, 0.0024754 , 0.00303073, 0.00345491, 0.00008197, 0.00100205, 0.00198565, 0.00108811, 0.00373155, 0.00004918, 0.00118647, 0.00902662, 0.00237295, 0.01599997, 0.00010451, 0.00236065, 0.00005533, 0.00824179, 0.00823769, 0.01118645, 0.00059221, 0.00196106, 0.00122951, 0.00003074, 0.00218032, 0.00021311],
    [0.00119057, 0.00031557, 0.00002049, 0.00003279, 0.00439958, 0.00001639, 0.0000082 , 0.00005123, 0.00080328, 0.00010041, 0.0000041 , 0.00194057, 0.00003074, 0.00002664, 0.00243852, 0.0000082 , 0.0000041 , 0.00092828, 0.00045082, 0.00020492, 0.00258811, 0.00001844, 0.00009016, 0.00000615, 0.00168852, 0.        ],
    [0.00338729, 0.00002459, 0.00037705, 0.00002869, 0.00362294, 0.00002049, 0.00001434, 0.00407581, 0.00123155, 0.00000205, 0.00244877, 0.00084426, 0.00001639, 0.00001639, 0.0041045 , 0.00002664, 0.00002459, 0.00128278, 0.00009221, 0.00142623, 0.00090164, 0.0000082 , 0.00003689, 0.        , 0.00015779, 0.0000123 ], 
    [0.00389548, 0.00158811, 0.00082172, 0.00095287, 0.00543851, 0.00111885, 0.00049795, 0.00159016, 0.00492212, 0.00014344, 0.00010861, 0.00113934, 0.00105533, 0.00104303, 0.00307376, 0.00060041, 0.00010861, 0.00115983, 0.00292622, 0.00398155, 0.00082377, 0.00021311, 0.00164549, 0.00001025, 0.00063729, 0.        ], 
    [0.0105676 , 0.00249385, 0.00433811, 0.01062703, 0.00576843, 0.00281762, 0.00203688, 0.00263524, 0.00401434, 0.00017623, 0.0003832 , 0.00568646, 0.00461884, 0.0103217 , 0.00294876, 0.00286065, 0.00084016, 0.01664546, 0.0139221 , 0.00822744, 0.00053279, 0.00254918, 0.00455327, 0.00077869, 0.00181147, 0.00003279], 
    [0.00210041, 0.00021516, 0.00026639, 0.00017418, 0.00156762, 0.00103278, 0.00013729, 0.00076639, 0.00231762, 0.00004508, 0.00002254, 0.00094467, 0.00036885, 0.0001291 , 0.00377458, 0.00017418, 0.00003484, 0.0017377 , 0.00058197, 0.00395901, 0.00085451, 0.00006557, 0.00041803, 0.        , 0.00018852, 0.0000041 ],
    [0.00239959, 0.00032787, 0.00022951, 0.00016393, 0.00252458, 0.00034426, 0.00044467, 0.00367827, 0.00150819, 0.00002664, 0.00001434, 0.00091188, 0.00035246, 0.00057787, 0.00209221, 0.00020492, 0.00004303, 0.00137295, 0.00134426, 0.00193442, 0.00069262, 0.00009426, 0.00046721, 0.00000205, 0.00018852, 0.00000205],
    [0.0130471 , 0.00026844, 0.00020492, 0.000125  , 0.02691593, 0.00018648, 0.00007172, 0.00054508, 0.01087498, 0.00002254, 0.00001434, 0.00021926, 0.00034221, 0.00018648, 0.00530327, 0.00013525, 0.00003074, 0.00095901, 0.00062705, 0.00315573, 0.00093647, 0.00004303, 0.0003791 , 0.00000205, 0.00046106, 0.        ],
    [0.0013586 , 0.00068442, 0.00355122, 0.00246516, 0.0021127 , 0.00139139, 0.00239754, 0.00028074, 0.00029713, 0.00003689, 0.00092828, 0.00395081, 0.00324589, 0.02060652, 0.00241393, 0.00128278, 0.00006148, 0.00241598, 0.00924793, 0.0088299 , 0.00005943, 0.00144877, 0.00035656, 0.00016393, 0.0000082 , 0.0001291 ], 
    [0.00023566, 0.00000205, 0.0000041 , 0.        , 0.00023156, 0.        , 0.00000205, 0.0000041 , 0.00003689, 0.0000041 , 0.        , 0.        , 0.00000205, 0.        , 0.00038934, 0.        , 0.00000205, 0.0000082 , 0.00001639, 0.0000041 , 0.00027869, 0.        , 0.        , 0.        , 0.        , 0.        ], 
    [0.00044057, 0.00017828, 0.00008607, 0.00005943, 0.00293852, 0.00013934, 0.00004098, 0.00017623, 0.00142008, 0.0000041 , 0.0000123 , 0.00022951, 0.00010451, 0.0007377 , 0.00030943, 0.00004508, 0.00000615, 0.00006557, 0.00073565, 0.00041188, 0.00004918, 0.00000615, 0.00023156, 0.00001025, 0.00015574, 0.        ], 
    [0.00451638, 0.00040574, 0.00033606, 0.00283196, 0.00878687, 0.00097131, 0.0001127 , 0.00040574, 0.00536064, 0.00003279, 0.00030328, 0.00632991, 0.00070697, 0.0002377 , 0.00404098, 0.00034836, 0.00001434, 0.0002459 , 0.00137295, 0.00168852, 0.00075   , 0.00029303, 0.00046926, 0.0000082 , 0.0038627 , 0.00000205], 
    [0.00491188, 0.00068442, 0.00009221, 0.00007992, 0.00638728, 0.00021926, 0.00004508, 0.00028484, 0.00202868, 0.00001434, 0.00001434, 0.00011066, 0.00072336, 0.00022131, 0.00383606, 0.00123975, 0.00002049, 0.00015779, 0.00095697, 0.00096106, 0.00088115, 0.0000123 , 0.00047951, 0.        , 0.00090983, 0.        ], 
    [0.00418852, 0.0008627 , 0.00295696, 0.01165981, 0.00602458, 0.00088524, 0.01052457, 0.0013668 , 0.00333196, 0.00010656, 0.00071311, 0.00107377, 0.00060656, 0.00092008, 0.00562294, 0.0005082 , 0.000125  , 0.00032787, 0.00394057, 0.0103176 , 0.00052664, 0.00036475, 0.0011127 , 0.00003893, 0.00103074, 0.00001844], 
    [0.00185655, 0.00169057, 0.00120696, 0.00175409, 0.00056762, 0.0082131 , 0.00054918, 0.00082992, 0.001125  , 0.00007787, 0.00100819, 0.00275614, 0.00494056, 0.00987498, 0.0031127 , 0.00126434, 0.00006762, 0.00875613, 0.00320081, 0.00497745, 0.00928072, 0.00108811, 0.00464343, 0.00002869, 0.0006209 , 0.00003893], 
    [0.0022418 , 0.00010656, 0.00004713, 0.00004303, 0.00378278, 0.00009631, 0.00001434, 0.00045082, 0.00140983, 0.00001025, 0.00002869, 0.00133811, 0.00014959, 0.00002049, 0.00271311, 0.00083606, 0.0000123 , 0.00193852, 0.00070082, 0.00142213, 0.00075615, 0.0000041 , 0.00015369, 0.00000205, 0.00007992, 0.        ], 
    [0.        , 0.        , 0.        , 0.        , 0.        , 0.        , 0.        , 0.        , 0.00000615, 0.00000205, 0.        , 0.        , 0.00000205, 0.        , 0.        , 0.        , 0.        , 0.        , 0.00000205, 0.00000205, 0.0018586 , 0.        , 0.        , 0.        , 0.        , 0.        ], 
    [0.00499589, 0.00096721, 0.00111885, 0.00214344, 0.01253071, 0.00059631, 0.0005041 , 0.00095287, 0.00531146, 0.00005123, 0.0006332 , 0.00103278, 0.00158401, 0.00152459, 0.00568032, 0.00100819, 0.00005533, 0.00122951, 0.00384425, 0.00442007, 0.00100819, 0.0004959 , 0.00088934, 0.00009221, 0.00192418, 0.        ], 
    [0.00649794, 0.00144467, 0.00192008, 0.00058197, 0.0075922 , 0.00114344, 0.00042828, 0.00512294, 0.00492007, 0.0001332 , 0.0005041 , 0.0013627 , 0.00142623, 0.0011168 , 0.00653892, 0.00252254, 0.00022336, 0.00045902, 0.00454302, 0.0126803 , 0.00237704, 0.00020082, 0.00238729, 0.00002664, 0.00048975, 0.0000041 ], 
    [0.00632171, 0.00107172, 0.00105942, 0.00060656, 0.00807785, 0.00084426, 0.00032377, 0.03355731, 0.00778277, 0.00008811, 0.00010041, 0.00202254, 0.0009959 , 0.00063934, 0.00978072, 0.00056352, 0.00007377, 0.00247336, 0.00412909, 0.00527253, 0.00216598, 0.00015369, 0.00251024, 0.00001434, 0.00129303, 0.0000123 ], 
    [0.00067623, 0.00065983, 0.00159016, 0.00065574, 0.00153073, 0.00019672, 0.00151844, 0.00006762, 0.00065574, 0.00000615, 0.00004508, 0.00273975, 0.00090369, 0.00339548, 0.00027254, 0.0016086 , 0.00000205, 0.00354303, 0.00333811, 0.00443442, 0.00000615, 0.00003484, 0.00017008, 0.00000615, 0.00004098, 0.00002459], 
    [0.00078483, 0.00000615, 0.0000041 , 0.        , 0.00611064, 0.        , 0.        , 0.00001025, 0.00152869, 0.00000205, 0.00000205, 0.0000041 , 0.00000205, 0.00001434, 0.0006332 , 0.00000615, 0.        , 0.0000041 , 0.        , 0.00004303, 0.00001844, 0.        , 0.00000205, 0.        , 0.00006148, 0.        ], 
    [0.00433811, 0.00016188, 0.00011475, 0.0001168 , 0.00284835, 0.00014549, 0.00003074, 0.0063463 , 0.00388114, 0.0000082 , 0.00004508, 0.00026639, 0.0001168 , 0.0012541 , 0.00191803, 0.00006352, 0.00001639, 0.00022131, 0.00057787, 0.00042418, 0.00003893, 0.00001434, 0.00017008, 0.00000205, 0.00006352, 0.0000123 ], 
    [0.000125  , 0.00000205, 0.00014549, 0.0000041 , 0.0001168 , 0.0000123 , 0.00000205, 0.00002869, 0.00018238, 0.        , 0.        , 0.00004713, 0.00001434, 0.        , 0.0000123 , 0.00018443, 0.        , 0.        , 0.0000123 , 0.00025615, 0.0000082 , 0.00006148, 0.00000615, 0.00013525, 0.00000615, 0.        ], 
    [0.0017418 , 0.00072131, 0.00066188, 0.00093033, 0.00202254, 0.00048565, 0.00025205, 0.0007418 , 0.00095287, 0.00007787, 0.00007377, 0.00044057, 0.00058402, 0.00029098, 0.00234221, 0.00050615, 0.00005123, 0.00042008, 0.00184426, 0.00171106, 0.00013115, 0.00010656, 0.00079508, 0.0000041 , 0.00016188, 0.00000205], 
    [0.00005943, 0.0000082 , 0.        , 0.0000041 , 0.00020697, 0.00000205, 0.        , 0.        , 0.00009016, 0.        , 0.        , 0.00001844, 0.0000041 , 0.        , 0.00007377, 0.        , 0.        , 0.        , 0.00000205, 0.00000205, 0.00000615, 0.        , 0.        , 0.        , 0.00003074, 0.00004508]])